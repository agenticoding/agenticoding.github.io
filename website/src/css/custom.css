/**
 * Any CSS included here will be global. The classic template
 * bundles Infima by default. Infima is a CSS framework designed to
 * work well for content-centric websites.
 */

/* Self-hosted font faces */
@import './fonts.css';

/* Import unified presentation system */
@import '../styles/presentation-system.css';

/* ========================================================================
   AGENTIC CODING — DESIGN TOKEN SYSTEM (Single Source of Truth)
   ========================================================================

   Token Architecture (per DESIGN_SYSTEM.md):
   1. Primitive — Raw palette values (--neutral-*, brand hex)
   2. Semantic — UI surfaces, text, borders, illustration (--surface-*, --text-*, --visual-*)
   3. Component — Per-component overrides (in .module.css files)

   Color System:
   - Achromatic base (C:0.000) — no tinted neutrals
   - 9 chromatic hues with equal standing — no privileged brand hue
   - Color = meaning — every hue use answers "what does this hue mean here?"
   - 60-30-10 budget — 60% achromatic, 30% elevated gray, 10% semantic color

   Style constraint: Flat only — no gradients, no shadows, no glows.
   Solid colors, clean borders, whitespace hierarchy.

   WCAG Accessibility:
   - Shade-600 on white >= 4.5:1 (light mode text)
   - Shade-400 on #0d1117 >= 4.5:1 (dark mode text)
   - Redundant encoding: every color signal has a non-color indicator

   ======================================================================== */

:root {
  /* === NEUTRAL SCALE — Pure achromatic (C:0.000) === */
  --neutral-50: #f5f5f5;
  --neutral-100: #e8e8e8;
  --neutral-200: #d4d4d4;
  --neutral-300: #b7b7b7;
  --neutral-400: #9b9b9b;
  --neutral-500: #808080;
  --neutral-600: #666666;
  --neutral-700: #505050;
  --neutral-800: #3d3d3d;
  --neutral-900: #2b2b2b;
  --neutral-950: #222222;

  /* === TYPOGRAPHY === */
  --font-display: 'Space Grotesk', system-ui, sans-serif;
  --font-body: 'Inter', system-ui, sans-serif;
  --font-mono: 'Monaspace Neon', monospace;
  --font-mono-ai: 'Monaspace Argon', var(--font-mono);
  --font-mono-spec: 'Monaspace Xenon', var(--font-mono);
  --font-mono-human: 'Monaspace Radon', var(--font-mono);
  --font-mono-keyword: 'Monaspace Krypton', var(--font-mono);
  --font-mono-features: 'calt' 1, 'liga' 0;

  /* === SPATIAL SYSTEM — 8px base grid === */
  --space-0: 0px;
  --space-px: 1px;
  --space-0h: 4px;
  --space-1: 8px;
  --space-2: 16px;
  --space-3: 24px;
  --space-4: 32px;
  --space-5: 48px;
  --space-6: 64px;
  --space-7: 80px;
  --space-8: 96px;
  --space-9: 128px;
  --space-10: 160px;

  /* === TYPE SCALE — Minor Third (1.200), base 16px === */
  --text-xs: 11px;
  --text-sm: 13px;
  --text-base: 16px;
  --text-lg: 19px;
  --text-xl: 23px;
  --text-2xl: 28px;
  --text-3xl: 33px;
  --text-4xl: 40px;
  --text-5xl: 48px;

  /* === LINE HEIGHTS — 8px-snapped === */
  --lh-tight: 16px;
  --lh-sm: 24px;
  --lh-lg: 32px;
  --lh-2xl: 40px;
  --lh-3xl: 48px;
  --lh-4xl: 56px;

  /* === BORDER RADIUS === */
  --radius-none: 0px;
  --radius-sm: 4px;
  --radius-md: 8px;
  --radius-lg: 12px;
  --radius-xl: 16px;
  --radius-2xl: 24px;
  --radius-full: 9999px;

  /* === STROKE WEIGHT SCALE — SVG illustration strokes === */
  --stroke-fine: 1px;
  --stroke-light: 1.5px;
  --stroke-default: 2px;
  --stroke-medium: 2.5px;
  --stroke-heavy: 3px;
  --stroke-accent: 4px;

  /* === ICON CANVAS — Square viewBox sizes === */
  --icon-sm: 16px;
  --icon-md: 24px;
  --icon-lg: 32px;
  --icon-xl: 48px;
  --icon-2xl: 64px;

  /* === INTERACTIVE TARGET SIZES === */
  --target-sm: 32px;
  --target-md: 40px;
  --target-lg: 48px;
  --target-xl: 56px;

  --ifm-font-family-base: var(--font-body);
  --ifm-heading-font-family: var(--font-display);
  --ifm-font-family-monospace: var(--font-mono);

  /* === NAVBAR — Flat, line-based (Design System rule #4) === */
  --ifm-navbar-background-color: var(--surface-page);
  --ifm-navbar-shadow: none;
  --ifm-navbar-height: var(--space-7);              /* 80px — 8px grid */
  --ifm-navbar-padding-horizontal: var(--space-5);  /* 48px */
  --ifm-navbar-padding-vertical: 0;
  --ifm-navbar-item-padding-horizontal: var(--space-2); /* 16px */
  --ifm-navbar-item-padding-vertical: 0;
  --ifm-navbar-link-color: var(--text-body);
  --ifm-navbar-link-hover-color: var(--text-heading);

  /* === DOC SIDEBAR — Design system tokens === */
  --ifm-menu-color: var(--text-body);
  --ifm-menu-color-active: var(--text-heading);
  --ifm-menu-color-background-active: var(--surface-raised);
  --ifm-menu-color-background-hover: var(--surface-muted);
  --ifm-menu-link-padding-horizontal: var(--space-2);     /* 16px, was 12px */
  --ifm-menu-link-padding-vertical: var(--space-1);       /* 8px, was 6px → 40px touch targets */
  --ifm-menu-link-sublist-icon-filter: none;
  --ifm-toc-border-color: var(--border-default);
  --docusaurus-collapse-button-bg: var(--surface-raised);
  --docusaurus-collapse-button-bg-hover: var(--surface-muted);
  --ifm-scrollbar-track-background-color: var(--surface-raised);
  --ifm-scrollbar-thumb-background-color: var(--neutral-300);
  --ifm-scrollbar-thumb-hover-background-color: var(--neutral-400);

  /* === SURFACE / TEXT / BORDER — Semantic layout tokens === */
  --surface-page: #ffffff;
  --surface-raised: var(--neutral-50);   /* #f5f5f5 */
  --surface-muted: var(--neutral-100);   /* #e8e8e8 */
  --text-heading: var(--neutral-900);    /* #2b2b2b */
  --text-body: var(--neutral-700);       /* #505050 */
  --text-muted: var(--neutral-500);      /* #808080 */
  --border-default: var(--neutral-200);  /* #d4d4d4 */

  /* Map to Infima layout variables */
  --ifm-background-color: var(--surface-page);
  --ifm-background-surface-color: var(--surface-raised);

  /* === UTILITY TOKENS === */
  --code-bg: var(--neutral-50);
  --text-subtle: var(--neutral-500);
  --icon-star: #e6aa63; /* warning-300 */

  /* === CHROMATIC PRIMITIVES — Raw palette values === */
  --cyan-300: #2ad0d0;
  --cyan-400: #00b2b2;
  --cyan-600: #007576;
  --cyan-700: #005c5c;

  /* === SEMANTIC COLORS === */
  --semantic-success: #007a44;  /* Success-600 (H:155°) */
  --semantic-warning: #8e5900;  /* Warning-600 (H:70°) */
  --semantic-error: #ad3735;    /* Error-600 (H:25°) */
  --semantic-info: #1369b0;     /* Indigo-600 (H:250°) */
  --semantic-neutral: #666666;  /* Neutral-600 */

  /* === MAP TO INFIMA (Docusaurus Framework) — Neutral primary === */
  --ifm-color-primary: var(--neutral-900);
  --ifm-color-primary-dark: var(--neutral-950);
  --ifm-color-primary-darker: var(--neutral-950);
  --ifm-color-primary-darkest: #000000;
  --ifm-color-primary-light: var(--neutral-800);
  --ifm-color-primary-lighter: var(--neutral-700);
  --ifm-color-primary-lightest: var(--neutral-600);

  /* === VISUAL ELEMENT COLORS — Diagram & illustration palette ===
     Role names for universal UI concepts (error, warning, success).
     Hue names for categorical diagram palette (cyan, indigo, etc.).
     See DESIGN_SYSTEM.md "Semantic Meaning Map" for hue→meaning. */

  /* Role-based (universal UI) */
  --visual-error: var(--semantic-error);      /* #ad3735 — Danger, critical */
  --visual-warning: var(--semantic-warning);  /* #8e5900 — Caution, attention */
  --visual-success: var(--semantic-success);  /* #007a44 — Validated, complete */
  --visual-neutral: var(--semantic-neutral);  /* #666666 — Neutral */

  /* Hue-based (categorical) */
  --visual-lime: #6b6b00;                    /* Lime-600 — Progress, growth */
  --visual-cyan: var(--cyan-600);            /* #007576 — System, code */
  --visual-indigo: var(--semantic-info);     /* #1369b0 — Knowledge, data */
  --visual-violet: #6057af;                  /* Violet-600 — AI transformation */
  --visual-magenta: #874895;                 /* Magenta-600 — AI creative */
  --visual-rose: #9b436a;                    /* Rose-600 — Human actor */

  /* === VISUAL ELEMENT BACKGROUNDS — 10% tint in light mode === */
  --visual-bg-error: color-mix(in srgb, var(--visual-error) 10%, transparent);
  --visual-bg-warning: color-mix(in srgb, var(--visual-warning) 10%, transparent);
  --visual-bg-lime: color-mix(in srgb, var(--visual-lime) 10%, transparent);
  --visual-bg-success: color-mix(in srgb, var(--visual-success) 10%, transparent);
  --visual-bg-cyan: color-mix(in srgb, var(--visual-cyan) 10%, transparent);
  --visual-bg-indigo: color-mix(in srgb, var(--visual-indigo) 10%, transparent);
  --visual-bg-violet: color-mix(in srgb, var(--visual-violet) 10%, transparent);
  --visual-bg-magenta: color-mix(in srgb, var(--visual-magenta) 10%, transparent);
  --visual-bg-rose: color-mix(in srgb, var(--visual-rose) 10%, transparent);
  --visual-bg-neutral: color-mix(in srgb, var(--visual-neutral) 10%, transparent);

  /* === GRADIENT ENDPOINTS (used by ContextWindowMeter) === */
  --gradient-warning-end: #cd8c37; /* Warning-400 */
  --gradient-critical-end: #ec7069; /* Error-400 */

  /* === TYPOGRAPHY & CODE === */
  --ifm-code-font-size: 95%;
  --docusaurus-highlighted-code-line-bg: rgba(0, 0, 0, 0.1);

  /* === CODE BLOCK BACKGROUNDS === */
  --code-bg-light: #f5f5f5; /* neutral-50 */

  /* === SEARCH PLUGIN — Design system overrides ===
     @easyops-cn/docusaurus-search-local CSS custom properties.
     Flat construction: no shadows. Design tokens for all colors.
     Contrast verified: active suggestion 14.16:1 light, 11.56:1 dark. */
  --search-local-modal-background: var(--surface-raised);
  --search-local-modal-shadow: none;
  --search-local-hit-background: var(--surface-page);
  --search-local-hit-shadow: none;
  --search-local-hit-color: var(--text-body);
  --search-local-highlight-color: var(--neutral-900);
  --search-local-hit-active-color: var(--surface-page);
  --search-local-muted-color: var(--text-muted);
  --search-local-input-active-border-color: transparent;
  --search-local-spacing: var(--space-2);
  --search-local-icon-stroke-width: 2;

  /* Search icon — stroke-based magnifying glass (light: #808080, 3.95:1 on white) */
  --ifm-navbar-search-input-icon: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16"><circle cx="6.5" cy="6.5" r="4.5" fill="none" stroke="%23808080" stroke-width="1.5"/><line x1="9.68" y1="9.68" x2="14" y2="14" stroke="%23808080" stroke-width="1.5" stroke-linecap="round"/></svg>');

  /* === ANNOUNCEMENT BAR === */
  --announcement-bg: #ffe3c3;  /* warning-100 */
  --announcement-text: #402400; /* warning-900 */
}

/* ========================================================================
   DARK MODE — Optimized Colors for Dark Backgrounds
   ========================================================================
   Semantic colors shift from shade-600 to shade-400.
   Visual bg tints shift from 10% to 15%.
   Surface colors use GitHub-style dark backgrounds.
   ======================================================================== */

[data-theme='dark'] {
  /* === SEMANTIC COLORS — shade-400 for dark mode === */
  --semantic-success: #48b475;  /* Success-400 */
  --semantic-warning: #cd8c37;  /* Warning-400 */
  --semantic-error: #ec7069;    /* Error-400 */
  --semantic-info: #53a0ec;     /* Indigo-400 */
  --semantic-neutral: #9b9b9b;  /* Neutral-400 */

  /* === GRADIENT ENDPOINTS (used by ContextWindowMeter) === */
  --gradient-warning-end: #e6aa63; /* Warning-300 */
  --gradient-critical-end: #ff958d; /* Error-300 */

  /* === MAP TO INFIMA — Neutral primary === */
  --ifm-color-primary: var(--neutral-100);
  --ifm-color-primary-dark: var(--neutral-200);
  --ifm-color-primary-darker: var(--neutral-300);
  --ifm-color-primary-darkest: var(--neutral-400);
  --ifm-color-primary-light: var(--neutral-50);
  --ifm-color-primary-lighter: #ffffff;
  --ifm-color-primary-lightest: #ffffff;

  /* === VISUAL ELEMENT COLORS — shade-400 for dark mode === */
  --visual-lime: #a1a22b;       /* Lime-400 */
  --visual-cyan: var(--cyan-400); /* Cyan-400 */
  --visual-violet: #938eeb;     /* Violet-400 */
  --visual-magenta: #c07ecf;    /* Magenta-400 */
  --visual-rose: #d7799f;       /* Rose-400 */

  /* === VISUAL ELEMENT BACKGROUNDS — 15% tint in dark mode === */
  --visual-bg-error: color-mix(in srgb, var(--visual-error) 15%, transparent);
  --visual-bg-warning: color-mix(in srgb, var(--visual-warning) 15%, transparent);
  --visual-bg-lime: color-mix(in srgb, var(--visual-lime) 15%, transparent);
  --visual-bg-success: color-mix(in srgb, var(--visual-success) 15%, transparent);
  --visual-bg-cyan: color-mix(in srgb, var(--visual-cyan) 15%, transparent);
  --visual-bg-indigo: color-mix(in srgb, var(--visual-indigo) 15%, transparent);
  --visual-bg-violet: color-mix(in srgb, var(--visual-violet) 15%, transparent);
  --visual-bg-magenta: color-mix(in srgb, var(--visual-magenta) 15%, transparent);
  --visual-bg-rose: color-mix(in srgb, var(--visual-rose) 15%, transparent);
  --visual-bg-neutral: color-mix(in srgb, var(--visual-neutral) 15%, transparent);

  /* === SURFACE / TEXT / BORDER — Dark mode === */
  --surface-page: #0d1117;
  --surface-raised: #161b22;
  --surface-muted: #3d3d3d;       /* neutral-800 */
  --text-heading: #e8e8e8;        /* neutral-100 */
  --text-body: #d4d4d4;           /* neutral-200 */
  --text-muted: #9b9b9b;          /* neutral-400 */
  --border-default: #505050;      /* neutral-700 */

  /* === DARK MODE BACKGROUNDS === */
  --ifm-background-color: var(--surface-page);
  --ifm-background-surface-color: var(--surface-raised);
  --code-bg-dark: #222222; /* neutral-950 */
  --ifm-font-color-base: #d4d4d4; /* neutral-200 */
  --ifm-heading-color: #e8e8e8;   /* neutral-100 */
  --code-bg: var(--neutral-950);
  --text-subtle: var(--neutral-400);
  --icon-star: #fcca91; /* warning-200 */

  /* === TYPOGRAPHY & CODE === */
  --docusaurus-highlighted-code-line-bg: rgba(0, 0, 0, 0.3);

  /* === DOC SIDEBAR — Dark mode === */
  --ifm-menu-link-sublist-icon-filter: none;
  --docusaurus-collapse-button-bg: var(--surface-raised);
  --docusaurus-collapse-button-bg-hover: var(--surface-muted);
  --ifm-scrollbar-track-background-color: var(--surface-raised);
  --ifm-scrollbar-thumb-background-color: var(--neutral-700);
  --ifm-scrollbar-thumb-hover-background-color: var(--neutral-600);

  /* === NAVBAR — Dark mode === */
  --ifm-navbar-background-color: var(--surface-page);
  --ifm-navbar-link-color: var(--text-body);
  --ifm-navbar-link-hover-color: var(--text-heading);

  /* === SEARCH PLUGIN — Dark mode overrides ===
     Active suggestion: light bg (#e8e8e8) with dark text (#2b2b2b), 11.56:1 contrast. */
  --search-local-highlight-color: var(--neutral-100);
  --search-local-hit-active-color: var(--neutral-900);

  /* Search icon — stroke-based magnifying glass (dark: #9b9b9b, 6.81:1 on #0d1117) */
  --ifm-navbar-search-input-icon: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16"><circle cx="6.5" cy="6.5" r="4.5" fill="none" stroke="%239b9b9b" stroke-width="1.5"/><line x1="9.68" y1="9.68" x2="14" y2="14" stroke="%239b9b9b" stroke-width="1.5" stroke-linecap="round"/></svg>');

  /* === ANNOUNCEMENT BAR === */
  --announcement-bg: #8e5900;  /* warning-600 */
  --announcement-text: #fff3e6; /* warning-50 */
}

/* ========================================================================
   CHANNEL SWITCH — Main content entrance animation
   ========================================================================
   Cross-channel navigation (/docs → /prompts) unmounts DocRoot entirely,
   so a CSS animation on the container fires only on channel switches.
   50ms delay staggers after the sidebar entrance (150ms in styles.module.css).
   ======================================================================== */

@keyframes channelEnter {
  from { opacity: 0; transform: translateY(4px); }
  to   { opacity: 1; transform: translateY(0); }
}

[class*='docMainContainer'] > .container {
  animation: channelEnter 200ms cubic-bezier(0.4, 0, 0.2, 1) 60ms both;
}

@media (prefers-reduced-motion: reduce) {
  [class*='docMainContainer'] > .container {
    animation: none !important;
  }
}

/* ========================================================================
   MERMAID DIAGRAM STYLING
   ======================================================================== */

[class*="container_"]:has(> svg[id^="mermaid"]) {
  display: flex;
  justify-content: center;
  align-items: center;
  margin: 2rem auto;
  padding: 1.5rem;
  background: var(--ifm-background-surface-color);
  border-radius: 8px;
  border: 1px solid var(--ifm-color-emphasis-300);
  text-align: center;
}

[class*="container_"]:has(> svg[id^="mermaid"]) > svg {
  max-width: 100%;
  height: auto;
  display: block;
  margin: 0 auto;
}

/* ========================================================================
   VISUAL CONTAINER CLASSES — Hue-based naming per design system
   ======================================================================== */

.visual-container {
  margin: 2rem 0;
  padding: 1.5rem;
  border-radius: 8px;
  border: 1px solid var(--ifm-color-emphasis-300);
}

.visual-container--cyan {
  background: var(--visual-bg-cyan);
  border-color: var(--visual-cyan);
}

.visual-container--success {
  background: var(--visual-bg-success);
  border-color: var(--visual-success);
}

.visual-container--warning {
  background: var(--visual-bg-warning);
  border-color: var(--visual-warning);
}

.visual-container--indigo {
  background: var(--visual-bg-indigo);
  border-color: var(--visual-indigo);
}

.visual-container--error {
  background: var(--visual-bg-error);
  border-color: var(--visual-error);
}

.visual-container--lime {
  background: var(--visual-bg-lime);
  border-color: var(--visual-lime);
}

.visual-container--violet {
  background: var(--visual-bg-violet);
  border-color: var(--visual-violet);
}

.visual-container--magenta {
  background: var(--visual-bg-magenta);
  border-color: var(--visual-magenta);
}

.visual-container--rose {
  background: var(--visual-bg-rose);
  border-color: var(--visual-rose);
}

.visual-container--neutral {
  background: var(--visual-bg-neutral);
  border-color: var(--visual-neutral);
}

/* ========================================================================
   VISUAL CHECKLIST STYLING
   ======================================================================== */

.visual-checklist {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
  margin: 1.5rem 0;
}

.visual-checklist-item {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  padding: 1rem;
  background: var(--ifm-background-surface-color);
  border-radius: 6px;
  border: 1px solid var(--ifm-color-emphasis-200);
  transition: border-color 0.2s ease;
}

.visual-checklist-item:hover {
  border-color: var(--neutral-400);
}

.visual-checklist-icon {
  font-size: 1.5rem;
  flex-shrink: 0;
}

.visual-checklist-text {
  font-size: 0.95rem;
  font-weight: 500;
}

/* ========================================================================
   ACCENT BORDERS — Semantic callout + live code blocks
   ======================================================================== */

.ai-gradient-border {
  border-left: 4px solid var(--neutral-400);
}

/* Apply accent border to live code blocks */
.theme-live-codeblock {
  border-left: 4px solid var(--neutral-400);
  margin: 2rem 0;
}

/* Subtle divider for major sections */
.gradient-divider {
  height: 2px;
  background: var(--border-default);
  margin: 3rem 0;
  border: none;
}

/* ========================================================================
   NAVBAR — Hidden on desktop, minimal on mobile
   ========================================================================
   All navigation is unified into the left sidebar on desktop (≥997px).
   Mobile retains the navbar shell (brand + hamburger only).
   ======================================================================== */

/* Hide navbar on desktop — sidebar-first layout */
@media (min-width: 997px) {
  .navbar {
    display: none;
  }

  :root {
    --ifm-navbar-height: 0px;
  }

  [data-theme='dark'] {
    --ifm-navbar-height: 0px;
  }
}

/* Sidebar right border — primary structural separator on desktop */
@media (min-width: 997px) {
  .theme-doc-sidebar-container {
    border-right: 1px solid var(--border-default);
    border-bottom: none;
  }
}

.navbar {
  border-bottom: 1px solid var(--neutral-300);
}

[data-theme='dark'] .navbar {
  border-bottom-color: var(--neutral-800);
}

/* Vertical alignment: center all elements, nudge brand to match link baselines */
.navbar__inner {
  align-items: center;
}

/* Brand: nudge up 1.5px to split the baseline gap between
   19px title (baseline at +3px) and 13px links (baseline at 0) */
.navbar__brand {
  transform: translateY(-1.5px);
}

.navbar__title {
  font-family: var(--font-display);
  font-weight: 600;
  font-size: var(--text-lg);
  line-height: var(--lh-lg);
  letter-spacing: -0.01em;
}

.navbar__logo {
  height: var(--space-3);
  margin-right: var(--space-1);
}

/* Nav links: Inter, small caps feel via uppercase + tracking */
.navbar__link {
  font-family: var(--font-body);
  font-weight: 400;
  font-size: var(--text-sm);
  line-height: var(--lh-sm);
  text-transform: uppercase;
  letter-spacing: 0.06em;
  text-decoration: none;
  padding-bottom: 2px;
  border-bottom: 1px solid transparent;
  transition: border-color 0.15s ease, font-weight 0.15s ease;
}

/* Hover: underline appears */
.navbar__link:hover {
  text-decoration: none;
  border-bottom: 1px solid var(--neutral-400);
}

[data-theme='dark'] .navbar__link:hover {
  border-bottom-color: var(--neutral-500);
}

/* Active: persistent underline, slightly heavier */
.navbar__link--active {
  font-weight: 500;
  text-decoration: none;
  border-bottom: 2px solid var(--text-heading);
}

/* Search input — flat, bordered */
.navbar__search-input {
  background: var(--surface-page);
  border: 1px solid var(--neutral-300);
  border-radius: var(--radius-sm);
  font-family: var(--font-body);
  font-size: var(--text-sm);
  height: var(--target-sm);
  color: var(--text-body);
}

.navbar__search-input:focus {
  border-color: var(--neutral-600);
  outline: none;
}

[data-theme='dark'] .navbar__search-input {
  background: var(--surface-page);
  border-color: var(--neutral-700);
  color: var(--text-body);
}

[data-theme='dark'] .navbar__search-input:focus {
  border-color: var(--neutral-400);
}

/* Color mode toggle — stable selector via swizzled Navbar/ColorModeToggle wrapper */
.color-mode-toggle button {
  border: 1px solid transparent;
  border-radius: var(--radius-sm);    /* 4px — input radius */
  width: var(--target-sm);            /* 32px — tertiary action */
  height: var(--target-sm);
  color: var(--text-muted);           /* match footer link weight */
  transition: background 0.15s ease, color 0.15s ease;
}

.color-mode-toggle svg {
  width: var(--icon-sm);              /* 16px — match search icon */
  height: var(--icon-sm);
}

.color-mode-toggle button:hover {
  background: var(--surface-muted);
  color: var(--text-heading);         /* match footer link hover */
}

.color-mode-toggle button:focus-visible {
  border-color: var(--neutral-600);
  outline: none;
}

[data-theme='dark'] .color-mode-toggle button:focus-visible {
  border-color: var(--neutral-400);
}

/* Search dropdown — flat border replaces shadow (design system: flat construction) */
[class*='dropdownMenu'] {
  border: 1px solid var(--border-default);
  border-radius: var(--radius-md);    /* 8px — container radius */
}

/* Search dropdown — sidebar context: align left, cap width to sidebar */
.theme-doc-sidebar-container [class*='dropdownMenu'] {
  left: 0;
  right: auto;
  max-width: calc(var(--doc-sidebar-width) - var(--space-4));
}


/* Mobile hamburger toggle */
@media (max-width: 996px) {
  .navbar__toggle {
    border: none;
    color: var(--text-body);
  }
}

/* Mobile sidebar — flat, no shadow */
.navbar-sidebar {
  background-color: var(--surface-page);
  box-shadow: none;
  border-right: 1px solid var(--neutral-300);
}

[data-theme='dark'] .navbar-sidebar {
  border-right-color: var(--neutral-800);
}

.navbar-sidebar__brand {
  box-shadow: none;
  border-bottom: 1px solid var(--neutral-300);
}

[data-theme='dark'] .navbar-sidebar__brand {
  border-bottom-color: var(--neutral-800);
}

/* Content area links — typographic interaction (Design System rule #4) */
.markdown a,
article a {
  text-decoration: underline;
  text-decoration-thickness: 1px;
  text-underline-offset: 2px;
}

/* Code block styling */
.theme-code-block {
  margin: 2rem 0;
}

/* Font features for all monospace containers */
code, pre, kbd, [class*="codeBlock"] {
  font-feature-settings: var(--font-mono-features);
}

/* Voice utility classes (per DESIGN_SYSTEM.md) */
.mono-ai { font-family: var(--font-mono-ai); }
.mono-spec { font-family: var(--font-mono-spec); }
.mono-human { font-family: var(--font-mono-human); }
.mono-keyword { font-family: var(--font-mono-keyword); }

/* ========================================================================
   DOC SIDEBAR — Design system conformance
   ========================================================================
   Typography: Inter for items, Space Grotesk for category labels.
   Spacing: 8px grid, 40px touch targets (--target-md).
   Colors: achromatic — typographic interaction (weight/contrast, not hue).
   Icons: mask-image replaces Infima's filter hack for dark mode.
   ======================================================================== */

/* Typography ------------------------------------------------------------ */

.menu {
  font-weight: 400;                     /* was 500; active items get 600 below */
}

.menu__link {
  font-size: var(--text-sm);            /* 13px, was ~14px inherited */
  line-height: var(--lh-sm);            /* 24px, was 1.25 (~17.5px) */
}

.menu__link--sublist {
  font-family: var(--font-display);     /* Space Grotesk for section headings */
  font-weight: 600;
  font-size: var(--text-sm);
  letter-spacing: -0.01em;
}

.menu__link--active:not(.menu__link--sublist) {
  font-weight: 600;                     /* active leaf item: weight bump */
}

/* Interactive states ---------------------------------------------------- */

.menu__link:hover {
  color: var(--text-heading);           /* contrast shift on hover */
}

/* Spacing --------------------------------------------------------------- */

.menu > .menu__list > .menu__list-item:not(:first-child) {
  margin-top: var(--space-2);           /* 16px between category groups */
}

/* Caret icons — mask-image approach (no filter hack) -------------------- */

.menu__link--sublist-caret::after,
.menu__caret::before {
  background: var(--text-muted);
  filter: none;
  mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24'%3E%3Cpath fill='black' d='M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z'/%3E%3C/svg%3E");
  -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24'%3E%3Cpath fill='black' d='M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z'/%3E%3C/svg%3E");
  mask-size: var(--icon-sm) var(--icon-sm);
  -webkit-mask-size: var(--icon-sm) var(--icon-sm);
  mask-repeat: no-repeat;
  -webkit-mask-repeat: no-repeat;
  mask-position: center;
  -webkit-mask-position: center;
  height: var(--icon-sm);               /* 16px, was 20px */
  width: var(--icon-sm);
}

.menu__link--sublist-caret::after {
  min-width: var(--icon-sm);            /* 16px, was 20px */
}

/* §N section marker — typographically secondary reference tag ----------- */

.sidebar-section-number {
  display: inline-block;
  font-family: var(--font-mono-keyword);  /* Monaspace Krypton — technical/mechanical voice */
  font-size: var(--text-xs);             /* 11px — visually subordinate */
  line-height: var(--lh-sm);            /* 24px — stays on baseline */
  color: var(--text-muted);             /* #808080 light / #9b9b9b dark */
  font-weight: 400;
  letter-spacing: 0.02em;
  margin-right: var(--space-0h);         /* 4px gap before label text */
  min-width: 1.8em;                      /* prevents label shift as numbers grow: §1 vs §14 */
  font-feature-settings: var(--font-mono-features);
}

.menu__link--active .sidebar-section-number {
  color: var(--text-body);              /* lift to body color when active — subtle emphasis */
}

/* ========================================================================
   ANNOUNCEMENT BANNER
   ======================================================================== */

div[class*='announcementBar'] {
  font-weight: 600;
  font-size: 0.95rem;
  text-align: center;
  border-bottom: 2px solid rgba(0, 0, 0, 0.1);
}

[data-theme='dark'] div[class*='announcementBar'] {
  border-bottom: 2px solid rgba(255, 255, 255, 0.1);
}
